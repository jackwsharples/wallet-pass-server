<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Redeem</title>
    <style>
      :root { --accent:#007aff; --bg:#0f172a; --fg:#e5e7eb; }
      html,body { height:100%; margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:#0b1020; color:var(--fg); }
      .wrap { display:grid; place-items:center; height:100%; padding:24px; }
      .card { width:min(520px, 92vw); background:#0f172a; border:1px solid #1f2a44; border-radius:16px; padding:24px; box-shadow: 0 10px 30px rgba(0,0,0,.4)}
      h1 { margin:0 0 8px; font-size:24px }
      label { display:block; margin:16px 0 6px; font-weight:600 }
      input { width:100%; padding:12px 14px; border-radius:10px; border:1px solid #334155; background:#111827; color:#e5e7eb }
      button { margin-top:16px; background:var(--accent); color:white; border:0; padding:12px 16px; border-radius:10px; font-weight:700; cursor:pointer }
      .hint { font-size:12px; opacity:.7; margin-top:6px }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="card">
        <h1>Redeem Code</h1>
        <label for="code">Code</label>
        <input id="code" placeholder="ABC234" />
        <label for="email">Email (optional)</label>
        <input id="email" placeholder="you@example.com" />
        <button id="btn">Redeem</button>
        <div id="msg" class="hint"></div>
      </div>
    </div>
    <script>
      const $ = (s)=>document.querySelector(s);
      $('#btn').addEventListener('click', async ()=>{
        const code = $('#code').value.trim();
        const email = $('#email').value.trim();
        const r = await fetch('/api/redeem', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ code, email: email || undefined })});
        const data = await r.json();
        if (!r.ok) { $('#msg').textContent = data.error || 'Redeem failed'; return; }
        window.location.href = '/api/pass/download?token=' + encodeURIComponent(data.token);
      });
    </script>
  </body>
  </html>

